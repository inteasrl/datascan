import{e$ as h,cc as X,ce as C,ca as T,b6 as H,eK as p,eL as v,bT as D,eI as s,bE as L}from"./dati-CSF_efAI.js";import{r as K,c as i,a as P}from"./vectorStacks-CiavLNzn.js";function Z(r){const I=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],u=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],n=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(I,u,n))}function B(r,I){const u=Math.sqrt(I[0]*I[0]+I[4]*I[4]+I[8]*I[8]),n=Math.sqrt(I[1]*I[1]+I[5]*I[5]+I[9]*I[9]),e=Math.sqrt(I[2]*I[2]+I[6]*I[6]+I[10]*I[10]);return h(r,u,n,e),r}function j(r,I,u){Math.abs(r[0])>Math.abs(r[1])?h(I,0,1,0):h(I,1,0,0),X(u,r,I),X(I,u,r),C(u,u),C(I,I)}function x(r=_){return[r[0],r[1],r[2],r[3]]}function rr(r=_[0],I=_[1],u=_[2],n=_[3]){return d(r,I,u,n,K.get())}function k(r,I){return d(I[0],I[1],I[2],I[3],r)}function Ir(r){return r}function d(r,I,u,n,e=x()){return e[0]=r,e[1]=I,e[2]=u,e[3]=n,e}function w(r,I,u){const n=I[0]*I[0]+I[1]*I[1]+I[2]*I[2],e=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return u[0]=I[0]*e,u[1]=I[1]*e,u[2]=I[2]*e,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function z(r,I,u,n=x()){const e=u[0]-I[0],o=u[1]-I[1],c=u[2]-I[2],t=r[0]-I[0],g=r[1]-I[1],O=r[2]-I[2],S=o*O-c*g,F=c*t-e*O,R=e*g-o*t,q=S*S+F*F+R*R,m=Math.abs(q-1)>1e-5&&q>1e-12?1/Math.sqrt(q):1;return n[0]=S*m,n[1]=F*m,n[2]=R*m,n[3]=-(n[0]*r[0]+n[1]*r[1]+n[2]*r[2]),n}function y(r,I,u,n=0,e=Math.floor(u*(1/3)),o=Math.floor(u*(2/3))){if(u<3)return!1;I(M,n);let c=e,t=!1;for(;c<u-1&&!t;)I(f,c),c++,t=!L(M,f);if(!t)return!1;for(c=Math.max(c,o),t=!1;c<u&&!t;)I(E,c),c++,s(U,M,f),C(U,U),s(l,f,E),C(l,l),t=!L(M,E)&&!L(f,E)&&Math.abs(T(U,l))<G;return t?(z(M,f,E,r),!0):(n!==0||e!==1||o!==2)&&y(r,I,u,0,1,2)}function ur(r,I,u=!0){const n=I.length/3;return y(r,(e,o)=>h(e,I[3*o+0],I[3*o+1],I[3*o+2]),u?n-1:n)}const G=.99619469809,M=D(),f=D(),E=D(),U=D(),l=D();function nr(r,I,u){return I!==r&&k(r,I),r[3]=-T(r,u),r}function er(r,I){return I[0]=-r[0],I[1]=-r[1],I[2]=-r[2],I[3]=-r[3],I}function tr(r,I,u,n){return X(E,I,r),w(u,E,n)}function cr(r,I,u,n){return A(b(r,I,s(i.get(),u,I),Q,n))}function or(r,I,u){return I!=null&&A(b(r,I.origin,I.direction,V,u))}function Nr(r,I,u){return A(b(r,I.origin,I.vector,a.NONE,u))}function ar(r,I,u){return A(b(r,I.origin,I.vector,a.CLAMP,u))}function ir(r,I){return $(r,I)>=0}function Er(r,I){const u=T(r,I.ray.direction),n=-$(r,I.ray.origin);if(u>-1e-6&&u<1e-6)return n>0;const e=n/u;return u>0?e<I.c1&&(I.c1=e):e>I.c0&&(I.c0=e),I.c0<=I.c1}function fr(r,I,u){const n=v(i.get(),r,-r[3]),e=J(r,s(i.get(),I,n),i.get());return p(u,e,n),u}function sr(r,I,u,n){const e=r,o=i.get(),c=i.get();j(e,o,c);const t=s(i.get(),u,I),g=P(o,t),O=P(c,t),S=P(e,t);return h(n,g,O,S)}function J(r,I,u){const n=v(i.get(),r,T(r,I));return s(u,I,n),u}function Tr(r,I){return Math.abs($(r,I))}function $(r,I){return T(r,I)+r[3]}var N;function A(r){return r===N.INTERSECTS_INSIDE_OUT||r===N.INTERSECTS_OUTSIDE_IN}function b(r,I,u,n,e){const o=T(r,u),c=$(r,I);if(o===0)return c>=0?N.INSIDE:N.OUTSIDE;let t=-c/o;return n&a.CLAMP&&(t=H(t,0,1)),!(n&a.INFINITE_MIN)&&t<0||!(n&a.INFINITE_MAX)&&t>1?c>=0?N.INSIDE:N.OUTSIDE:(p(e,I,v(e,u,t)),c>=0?N.INTERSECTS_INSIDE_OUT:N.INTERSECTS_OUTSIDE_IN)}(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE"})(N||(N={}));const _=[0,0,1,0];var a;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(a||(a={}));const Q=a.INFINITE_MIN|a.INFINITE_MAX,V=a.INFINITE_MAX;export{ur as A,rr as D,Er as G,fr as H,sr as J,er as L,x as M,Ir as O,tr as P,Tr as Q,d as U,$ as V,j as a,B as g,k as h,cr as k,w as l,Z as m,z as p,or as q,y as v,ar as w,Nr as x,nr as y,ir as z};
